{"componentChunkName":"component---src-templates-post-jsx","path":"/NotionApiImageUrl/","result":{"data":{"site":{"siteMetadata":{"title":"Cho's Blog"}},"markdownRemark":{"id":"095c65d5-fcc7-52e9-81c3-c2fb94b5a36c","excerpt":"개발 환경 Next.js   react  vercel 배포 문제 상황 Notion API를 사용하여 웹 프로젝트를 만들던 중, 아래와 같이 사진 파일이 보이지 않는 문제가 발생하였다. \n 또, Vercel의 이미지 캐싱 쓰기 횟수가 이미지 양에 비해 상당히 높은 문제도 발생하였다.\n 원인 노션 API를 사용하여 특정 데이터베이스의 파일 정보를 가져오게 된…","html":"<blockquote>\n<h3 id=\"개발-환경\" style=\"position:relative;\"><a href=\"#%EA%B0%9C%EB%B0%9C-%ED%99%98%EA%B2%BD\" aria-label=\"개발 환경 permalink\" class=\"heading-anchor before\"><svg xmlns=\"http://www.w3.org/2000/svg\" width=\"15\" height=\"15\" viewBox=\"0 0 24 24\"><path d=\"M6.188 8.719c.439-.439.926-.801 1.444-1.087 2.887-1.591 6.589-.745 8.445 2.069l-2.246 2.245c-.644-1.469-2.243-2.305-3.834-1.949-.599.134-1.168.433-1.633.898l-4.304 4.306c-1.307 1.307-1.307 3.433 0 4.74 1.307 1.307 3.433 1.307 4.74 0l1.327-1.327c1.207.479 2.501.67 3.779.575l-2.929 2.929c-2.511 2.511-6.582 2.511-9.093 0s-2.511-6.582 0-9.093l4.304-4.306zm6.836-6.836l-2.929 2.929c1.277-.096 2.572.096 3.779.574l1.326-1.326c1.307-1.307 3.433-1.307 4.74 0 1.307 1.307 1.307 3.433 0 4.74l-4.305 4.305c-1.311 1.311-3.44 1.3-4.74 0-.303-.303-.564-.68-.727-1.051l-2.246 2.245c.236.358.481.667.796.982.812.812 1.846 1.417 3.036 1.704 1.542.371 3.194.166 4.613-.617.518-.286 1.005-.648 1.444-1.087l4.304-4.305c2.512-2.511 2.512-6.582.001-9.093-2.511-2.51-6.581-2.51-9.092 0z\"/></svg></a>개발 환경</h3>\n<ul>\n<li>Next.js  <code class=\"language-text\">v15.4.6</code></li>\n<li>react <code class=\"language-text\">v19.1.0</code></li>\n<li>vercel 배포</li>\n</ul>\n</blockquote>\n<h2 id=\"문제-상황\" style=\"position:relative;\"><a href=\"#%EB%AC%B8%EC%A0%9C-%EC%83%81%ED%99%A9\" aria-label=\"문제 상황 permalink\" class=\"heading-anchor before\"><svg xmlns=\"http://www.w3.org/2000/svg\" width=\"15\" height=\"15\" viewBox=\"0 0 24 24\"><path d=\"M6.188 8.719c.439-.439.926-.801 1.444-1.087 2.887-1.591 6.589-.745 8.445 2.069l-2.246 2.245c-.644-1.469-2.243-2.305-3.834-1.949-.599.134-1.168.433-1.633.898l-4.304 4.306c-1.307 1.307-1.307 3.433 0 4.74 1.307 1.307 3.433 1.307 4.74 0l1.327-1.327c1.207.479 2.501.67 3.779.575l-2.929 2.929c-2.511 2.511-6.582 2.511-9.093 0s-2.511-6.582 0-9.093l4.304-4.306zm6.836-6.836l-2.929 2.929c1.277-.096 2.572.096 3.779.574l1.326-1.326c1.307-1.307 3.433-1.307 4.74 0 1.307 1.307 1.307 3.433 0 4.74l-4.305 4.305c-1.311 1.311-3.44 1.3-4.74 0-.303-.303-.564-.68-.727-1.051l-2.246 2.245c.236.358.481.667.796.982.812.812 1.846 1.417 3.036 1.704 1.542.371 3.194.166 4.613-.617.518-.286 1.005-.648 1.444-1.087l4.304-4.305c2.512-2.511 2.512-6.582.001-9.093-2.511-2.51-6.581-2.51-9.092 0z\"/></svg></a>문제 상황</h2>\n<p>Notion API를 사용하여 웹 프로젝트를 만들던 중, 아래와 같이 사진 파일이 보이지 않는 문제가 발생하였다.\n<span class='gatsby-resp-image-wrapper' style='position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 680px; margin-bottom: 16px;'>\n      <a class='gatsby-resp-image-link' href='/blog/static/ecb4646aa641c25de0aeffa8a5da5f21/f9c26/n-1.png' style='display: block' target='_blank' rel='noopener'>\n    <span class='gatsby-resp-image-background-image' style=\"padding-bottom: 62.35294117647059%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAYAAABiDJ37AAAACXBIWXMAABYlAAAWJQFJUiTwAAABTElEQVR42m2S2a6DMAxE+9idAiGsCUvVW/7/B90cuEYgeBgl8tjjsZOT904+n4+M41fqupaqKqUsiwXWZpLnVoqiEGNSSZJ4gyyb+Swz0ratnKy1kqZGnPfS9X0Idjv4kNgGzoccitYgRjOEnfNyyvM8uMgnd13X7QqI1XUT3JbBfXUINGZBNzsEFCB6BLgkSTZI03QB9TtBumD9CPCv10viOJ7A/Xa7yf1+n4DYTpCAMeYQcIyta2DM5/Mpl8tFzufzkrMRxLo6WAM38O20y3kFTdNMj8EJmA5RchZB9kLXKIo2IAZHIQ6cm0VUWAUx9PcdZ0ECOGGE6/W62Q93uPUENFivBA3Ovh+2DilUp+xGd/R4PGT9eJzkKPRRWMMiSAeWzVjc1SknTuF4EHheniY6gTod3u9/wcxKExL5b0ffhrhCP/Ga10cZhkF+svsuRGomYzAAAAAASUVORK5CYII='); background-size: cover; display: block;\"></span>\n  <img class='gatsby-resp-image-image' alt='n 1' title='' src='/blog/static/ecb4646aa641c25de0aeffa8a5da5f21/ca1dc/n-1.png' srcset='/blog/static/ecb4646aa641c25de0aeffa8a5da5f21/e7570/n-1.png 170w,\n/blog/static/ecb4646aa641c25de0aeffa8a5da5f21/f46e7/n-1.png 340w,\n/blog/static/ecb4646aa641c25de0aeffa8a5da5f21/ca1dc/n-1.png 680w,\n/blog/static/ecb4646aa641c25de0aeffa8a5da5f21/02d09/n-1.png 1020w,\n/blog/static/ecb4646aa641c25de0aeffa8a5da5f21/9d567/n-1.png 1360w,\n/blog/static/ecb4646aa641c25de0aeffa8a5da5f21/f9c26/n-1.png 2880w' sizes='(max-width: 680px) 100vw, 680px' style='width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;' loading='lazy' decoding='async'>\n  </a>\n    </span></p>\n<p>또, Vercel의 이미지 캐싱 쓰기 횟수가 이미지 양에 비해 상당히 높은 문제도 발생하였다.\n<span class='gatsby-resp-image-wrapper' style='position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 680px; margin-bottom: 16px;'>\n      <a class='gatsby-resp-image-link' href='/blog/static/75a536014546b0e439b0d5b62232d650/01d29/n-3.png' style='display: block' target='_blank' rel='noopener'>\n    <span class='gatsby-resp-image-background-image' style=\"padding-bottom: 57.64705882352942%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAYAAABiDJ37AAAACXBIWXMAABYlAAAWJQFJUiTwAAABnUlEQVR42qVTTUvDQBTcvN2k+WzSJkXa2pa2CEIVT4IXL1bBH+BBEDx5qOLJHgrib9Cf6k8Y39ukVWuLgodh37LzZudNNqrV7iHLGowMeZ7DdV0QEWq1GpRScASOsxW+7yMIAgvpU4NBH+1OG51OB91uF/V63YoKRFR7IciU4psQRRHSNLV9VnDTrVrrFYgMHNLfRITzdRWeMabci3ocx9aR3NZsNu0q7jzP++FImoQvkPMkSXD/8IjX1zcMh0OooihWBBEtXdHK7aYx5XzF4X0WumjlDe5nAxLmMi+bwS8foYRkxWOSQrizD7V3Db8Yg+TCTxcVmfNytFvV7EKbtZoq5w5CrdC7fIF6BvrTJ/h8gbIjOqqEjMJkUtvqap+N2NUVoqSJ3sWiFDyfIxBBS6zFoLAoyYMp6HgB8iJQcQCa3Fb1BHQ0A7n8jA7voOZAMDrD7skN1Owd3dNZ5ZA/N/Eo2vPL/IIcujHmmkfzEpi0x7lIHcNkA3bAcfBTMmFmcwz8APWMfwjud3hKZVxv66P9K7QmuMt3+F+xdXwAdF8MgAV+9doAAAAASUVORK5CYII='); background-size: cover; display: block;\"></span>\n  <img class='gatsby-resp-image-image' alt='n 3' title='' src='/blog/static/75a536014546b0e439b0d5b62232d650/ca1dc/n-3.png' srcset='/blog/static/75a536014546b0e439b0d5b62232d650/e7570/n-3.png 170w,\n/blog/static/75a536014546b0e439b0d5b62232d650/f46e7/n-3.png 340w,\n/blog/static/75a536014546b0e439b0d5b62232d650/ca1dc/n-3.png 680w,\n/blog/static/75a536014546b0e439b0d5b62232d650/02d09/n-3.png 1020w,\n/blog/static/75a536014546b0e439b0d5b62232d650/9d567/n-3.png 1360w,\n/blog/static/75a536014546b0e439b0d5b62232d650/01d29/n-3.png 2536w' sizes='(max-width: 680px) 100vw, 680px' style='width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;' loading='lazy' decoding='async'>\n  </a>\n    </span></p>\n<h2 id=\"원인\" style=\"position:relative;\"><a href=\"#%EC%9B%90%EC%9D%B8\" aria-label=\"원인 permalink\" class=\"heading-anchor before\"><svg xmlns=\"http://www.w3.org/2000/svg\" width=\"15\" height=\"15\" viewBox=\"0 0 24 24\"><path d=\"M6.188 8.719c.439-.439.926-.801 1.444-1.087 2.887-1.591 6.589-.745 8.445 2.069l-2.246 2.245c-.644-1.469-2.243-2.305-3.834-1.949-.599.134-1.168.433-1.633.898l-4.304 4.306c-1.307 1.307-1.307 3.433 0 4.74 1.307 1.307 3.433 1.307 4.74 0l1.327-1.327c1.207.479 2.501.67 3.779.575l-2.929 2.929c-2.511 2.511-6.582 2.511-9.093 0s-2.511-6.582 0-9.093l4.304-4.306zm6.836-6.836l-2.929 2.929c1.277-.096 2.572.096 3.779.574l1.326-1.326c1.307-1.307 3.433-1.307 4.74 0 1.307 1.307 1.307 3.433 0 4.74l-4.305 4.305c-1.311 1.311-3.44 1.3-4.74 0-.303-.303-.564-.68-.727-1.051l-2.246 2.245c.236.358.481.667.796.982.812.812 1.846 1.417 3.036 1.704 1.542.371 3.194.166 4.613-.617.518-.286 1.005-.648 1.444-1.087l4.304-4.305c2.512-2.511 2.512-6.582.001-9.093-2.511-2.51-6.581-2.51-9.092 0z\"/></svg></a>원인</h2>\n<p>노션 API를 사용하여 특정 데이터베이스의 파일 정보를 가져오게 된다면 아래와 같은 URL형식으로 받을 수 있게 된다.</p>\n<div class=\"gatsby-highlight\" data-language=\"json\"><pre class=\"language-json\"><code class=\"language-json\"><span class=\"token comment\">// 노션 API의 응답 중 이미지 url에 관련된 일부분</span>\n\n<span class=\"token comment\">//...</span>\n<span class=\"token punctuation\">{</span>\n\t<span class=\"token property\">\"name\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"IMG_0750.JPG\"</span><span class=\"token punctuation\">,</span>\n\t<span class=\"token property\">\"type\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"file\"</span><span class=\"token punctuation\">,</span>\n\t<span class=\"token property\">\"file\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n\t\t<span class=\"token property\">\"url\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"https://prod-files-secure.s3.us-west-2.amazonaws.com/c82cac33-9f75-811d-b353-0003cf829c63/b916f417-f8b3-4fc7-bf3f-76c04abd7716/IMG_0750.jpg?...\"</span><span class=\"token punctuation\">,</span>\n\t\t<span class=\"token property\">\"expiry_time\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"2025-08-28T09:29:09.038Z\"</span>\n\t<span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n<span class=\"token comment\">//...</span></code></pre></div>\n<p>json을 살펴보면 알 수 있듯이 파일 url에 만료 기간이 정해저 있기 때문에 만료기간 이후 url을 갱신할 필요가 있다. 또, 매번 url이 달라지기 때문에 같은 이미지라 해도 vercel에서는 다른 이미지로 인식하기 때문에 매번 캐시에 이미지를 저장하는 문제가 발생한다.</p>\n<blockquote>\n<p>url을 보면 <code class=\"language-text\">X-Amz-Expires</code>이라는 값을 확인할 수 있는데 이는 AWS에서 재공하는 pre-signed URL에 유효 기간을 초단위로 나타내는 파라미터이다. <a href=\"https://aws.amazon.com/ko/blogs/korea/aws-api-call-2-s3-pre-signed-url/\">자세한 내용</a></p>\n</blockquote>\n<h2 id=\"시도1-fetch에-revalidate-설정-실패\" style=\"position:relative;\"><a href=\"#%EC%8B%9C%EB%8F%841-fetch%EC%97%90-revalidate-%EC%84%A4%EC%A0%95-%EC%8B%A4%ED%8C%A8\" aria-label=\"시도1 fetch에 revalidate 설정 실패 permalink\" class=\"heading-anchor before\"><svg xmlns=\"http://www.w3.org/2000/svg\" width=\"15\" height=\"15\" viewBox=\"0 0 24 24\"><path d=\"M6.188 8.719c.439-.439.926-.801 1.444-1.087 2.887-1.591 6.589-.745 8.445 2.069l-2.246 2.245c-.644-1.469-2.243-2.305-3.834-1.949-.599.134-1.168.433-1.633.898l-4.304 4.306c-1.307 1.307-1.307 3.433 0 4.74 1.307 1.307 3.433 1.307 4.74 0l1.327-1.327c1.207.479 2.501.67 3.779.575l-2.929 2.929c-2.511 2.511-6.582 2.511-9.093 0s-2.511-6.582 0-9.093l4.304-4.306zm6.836-6.836l-2.929 2.929c1.277-.096 2.572.096 3.779.574l1.326-1.326c1.307-1.307 3.433-1.307 4.74 0 1.307 1.307 1.307 3.433 0 4.74l-4.305 4.305c-1.311 1.311-3.44 1.3-4.74 0-.303-.303-.564-.68-.727-1.051l-2.246 2.245c.236.358.481.667.796.982.812.812 1.846 1.417 3.036 1.704 1.542.371 3.194.166 4.613-.617.518-.286 1.005-.648 1.444-1.087l4.304-4.305c2.512-2.511 2.512-6.582.001-9.093-2.511-2.51-6.581-2.51-9.092 0z\"/></svg></a>시도1. fetch에 revalidate 설정 (실패)</h2>\n<p>next.js의 fetch에는 revalidate라는 옵션을 설정해서 특정 시간마다 저장해둔 캐시 데이터를 갱신 시키도록 할 수 있다. revalidate를 1시간(3600초) 보다 빠르게 설정한다면 파일 url이 만료되기 전 새로운 url을 갱신하게 되어 이미지가 보이지 않는 문제를 해결할 수 있을 것이다. <a href=\"https://nextjs.org/docs/app/getting-started/caching-and-revalidating#unstable_cache\">공식 문서</a></p>\n<h3 id=\"실패-갱신된-이미지-만료-후-사이트-진입시-여전히-이미지가-보이지-않음\" style=\"position:relative;\"><a href=\"#%EC%8B%A4%ED%8C%A8-%EA%B0%B1%EC%8B%A0%EB%90%9C-%EC%9D%B4%EB%AF%B8%EC%A7%80-%EB%A7%8C%EB%A3%8C-%ED%9B%84-%EC%82%AC%EC%9D%B4%ED%8A%B8-%EC%A7%84%EC%9E%85%EC%8B%9C-%EC%97%AC%EC%A0%84%ED%9E%88-%EC%9D%B4%EB%AF%B8%EC%A7%80%EA%B0%80-%EB%B3%B4%EC%9D%B4%EC%A7%80-%EC%95%8A%EC%9D%8C\" aria-label=\"실패 갱신된 이미지 만료 후 사이트 진입시 여전히 이미지가 보이지 않음 permalink\" class=\"heading-anchor before\"><svg xmlns=\"http://www.w3.org/2000/svg\" width=\"15\" height=\"15\" viewBox=\"0 0 24 24\"><path d=\"M6.188 8.719c.439-.439.926-.801 1.444-1.087 2.887-1.591 6.589-.745 8.445 2.069l-2.246 2.245c-.644-1.469-2.243-2.305-3.834-1.949-.599.134-1.168.433-1.633.898l-4.304 4.306c-1.307 1.307-1.307 3.433 0 4.74 1.307 1.307 3.433 1.307 4.74 0l1.327-1.327c1.207.479 2.501.67 3.779.575l-2.929 2.929c-2.511 2.511-6.582 2.511-9.093 0s-2.511-6.582 0-9.093l4.304-4.306zm6.836-6.836l-2.929 2.929c1.277-.096 2.572.096 3.779.574l1.326-1.326c1.307-1.307 3.433-1.307 4.74 0 1.307 1.307 1.307 3.433 0 4.74l-4.305 4.305c-1.311 1.311-3.44 1.3-4.74 0-.303-.303-.564-.68-.727-1.051l-2.246 2.245c.236.358.481.667.796.982.812.812 1.846 1.417 3.036 1.704 1.542.371 3.194.166 4.613-.617.518-.286 1.005-.648 1.444-1.087l4.304-4.305c2.512-2.511 2.512-6.582.001-9.093-2.511-2.51-6.581-2.51-9.092 0z\"/></svg></a>실패) 갱신된 이미지 만료 후 사이트 진입시 여전히 이미지가 보이지 않음</h3>\n<p>만료되지 않은 이미지가 캐싱되고 1시간 이상 지난 뒤에 다시 사이트에 진입하기 되면, 여전히 캐싱된 이미지(이미 만료된 이미지)를 보여줌.</p>\n<p>수동으로 재로딩(<code class=\"language-text\">Cmd + R</code>)을 하면 갱신이 되지만, 해당 방법으로는 Vercel에서 이미지 캐시 낭비 문제를 해결할 수 없기 때문에 다른 방법이 필요함.</p>\n<h2 id=\"시도2-Notion-페이지-게시를-활용한-정적-이미지-URL-사용-성공\" style=\"position:relative;\"><a href=\"#%EC%8B%9C%EB%8F%842-Notion-%ED%8E%98%EC%9D%B4%EC%A7%80-%EA%B2%8C%EC%8B%9C%EB%A5%BC-%ED%99%9C%EC%9A%A9%ED%95%9C-%EC%A0%95%EC%A0%81-%EC%9D%B4%EB%AF%B8%EC%A7%80-URL-%EC%82%AC%EC%9A%A9-%EC%84%B1%EA%B3%B5\" aria-label=\"시도2 Notion 페이지 게시를 활용한 정적 이미지 URL 사용 성공 permalink\" class=\"heading-anchor before\"><svg xmlns=\"http://www.w3.org/2000/svg\" width=\"15\" height=\"15\" viewBox=\"0 0 24 24\"><path d=\"M6.188 8.719c.439-.439.926-.801 1.444-1.087 2.887-1.591 6.589-.745 8.445 2.069l-2.246 2.245c-.644-1.469-2.243-2.305-3.834-1.949-.599.134-1.168.433-1.633.898l-4.304 4.306c-1.307 1.307-1.307 3.433 0 4.74 1.307 1.307 3.433 1.307 4.74 0l1.327-1.327c1.207.479 2.501.67 3.779.575l-2.929 2.929c-2.511 2.511-6.582 2.511-9.093 0s-2.511-6.582 0-9.093l4.304-4.306zm6.836-6.836l-2.929 2.929c1.277-.096 2.572.096 3.779.574l1.326-1.326c1.307-1.307 3.433-1.307 4.74 0 1.307 1.307 1.307 3.433 0 4.74l-4.305 4.305c-1.311 1.311-3.44 1.3-4.74 0-.303-.303-.564-.68-.727-1.051l-2.246 2.245c.236.358.481.667.796.982.812.812 1.846 1.417 3.036 1.704 1.542.371 3.194.166 4.613-.617.518-.286 1.005-.648 1.444-1.087l4.304-4.305c2.512-2.511 2.512-6.582.001-9.093-2.511-2.51-6.581-2.51-9.092 0z\"/></svg></a>시도2. Notion 페이지 게시를 활용한 정적 이미지 URL 사용 (성공)</h2>\n<p>노션 API로 불러오는 페이지를 게시하기 되면 해당 페이지의 게시 URL이 생기게 되는데, 이 URL을 통해 정적인 사진 URL을 얻을 수 있어 이미지가 보이지 않는 문제와 캐싱 문제를 해결할 수 있을 것이다.</p>\n<h3 id=\"게시된-사이트의-이미지-URL-분석\" style=\"position:relative;\"><a href=\"#%EA%B2%8C%EC%8B%9C%EB%90%9C-%EC%82%AC%EC%9D%B4%ED%8A%B8%EC%9D%98-%EC%9D%B4%EB%AF%B8%EC%A7%80-URL-%EB%B6%84%EC%84%9D\" aria-label=\"게시된 사이트의 이미지 URL 분석 permalink\" class=\"heading-anchor before\"><svg xmlns=\"http://www.w3.org/2000/svg\" width=\"15\" height=\"15\" viewBox=\"0 0 24 24\"><path d=\"M6.188 8.719c.439-.439.926-.801 1.444-1.087 2.887-1.591 6.589-.745 8.445 2.069l-2.246 2.245c-.644-1.469-2.243-2.305-3.834-1.949-.599.134-1.168.433-1.633.898l-4.304 4.306c-1.307 1.307-1.307 3.433 0 4.74 1.307 1.307 3.433 1.307 4.74 0l1.327-1.327c1.207.479 2.501.67 3.779.575l-2.929 2.929c-2.511 2.511-6.582 2.511-9.093 0s-2.511-6.582 0-9.093l4.304-4.306zm6.836-6.836l-2.929 2.929c1.277-.096 2.572.096 3.779.574l1.326-1.326c1.307-1.307 3.433-1.307 4.74 0 1.307 1.307 1.307 3.433 0 4.74l-4.305 4.305c-1.311 1.311-3.44 1.3-4.74 0-.303-.303-.564-.68-.727-1.051l-2.246 2.245c.236.358.481.667.796.982.812.812 1.846 1.417 3.036 1.704 1.542.371 3.194.166 4.613-.617.518-.286 1.005-.648 1.444-1.087l4.304-4.305c2.512-2.511 2.512-6.582.001-9.093-2.511-2.51-6.581-2.51-9.092 0z\"/></svg></a>게시된 사이트의 이미지 URL 분석</h3>\n<p><figure class='gatsby-resp-image-figure' style='margin-bottom: 16px;'>\n    <span class='gatsby-resp-image-wrapper' style='position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 680px; '>\n      <a class='gatsby-resp-image-link' href='/blog/static/24bf16e5e8dd5710754e62951eafa2e8/dce07/n-4.png' style='display: block' target='_blank' rel='noopener'>\n    <span class='gatsby-resp-image-background-image' style=\"padding-bottom: 55.88235294117647%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAABYlAAAWJQFJUiTwAAACUklEQVR42l2TaU/bQBCGLbWVWgooUQq5oxx27Ni5fNtZO859IERKJRBUbeEHhNJW4kNbtX/97ewiBOXDq5Gl9eNnZsdSoVBApVJBtVpFrVaFbVswDB2dTgdBGMELGFzXFfE8D/NkiNUoxnoYYpUwLKZTzIZDzKMQy9kCUiaTwe7uW+zt7SObzeLg4EBUWZbRbCpQFIVqU9SWpiEOQzDfx8R3EPYNWN0eBvTMPBe+70EaRgm226+4uroWpuVyGcVi8R7Qaolo2n3lQA6LohjJeIxGo4GdnTfUTRvj0QgDxiANRkt8uLjChA6USmVxSFVVKGSlEuhpmqoGy3Ywmy+wXK1xcrLBlFoOuHXEEAQ+pFy+hFQ6g3Q6hXw+L2AWzbGl1GE8S0uuwW2rNDOGGc3xdLPB8fEJVssjrCnT2RKS1W1DU2TkCMYviBtq1Nqhu0IqvkA6OqOci6TYGd4llzBOb2Cf3cK7vEN0/Rfsy28En3/BnW0g9U2LrAhweCgMOYzf9P7wI14sv+HVYku5EXk53+L16hb1iz9onP+Ef/kDi+s7jD59R3i+hRmTodyoo1gqCTueWq0moLx1Xp+nY/po6W3U6b3xZILN5j3mNFN+UZ4fQFLkOirlEtkVhKGu6+h2u2JVnoL4B3TDQMwSRK6DsdvHNLAReQ6Ya4PZJiyzD6mn08yUKrK5xxk+7N5/dhyoGwhp0QdkEhHEt/rwXQ+hY8Hp9dAzTUg2rYGiqMjlssgTkL9skMnDHj5CVWEfDyIkAf0xvomx00McBGLZB3Yfjm3jH21bWWAUd4UxAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"></span>\n  <img class='gatsby-resp-image-image' alt='게시한 사이트의 이미지 URL' title='' src='/blog/static/24bf16e5e8dd5710754e62951eafa2e8/ca1dc/n-4.png' srcset='/blog/static/24bf16e5e8dd5710754e62951eafa2e8/e7570/n-4.png 170w,\n/blog/static/24bf16e5e8dd5710754e62951eafa2e8/f46e7/n-4.png 340w,\n/blog/static/24bf16e5e8dd5710754e62951eafa2e8/ca1dc/n-4.png 680w,\n/blog/static/24bf16e5e8dd5710754e62951eafa2e8/02d09/n-4.png 1020w,\n/blog/static/24bf16e5e8dd5710754e62951eafa2e8/9d567/n-4.png 1360w,\n/blog/static/24bf16e5e8dd5710754e62951eafa2e8/dce07/n-4.png 2208w' sizes='(max-width: 680px) 100vw, 680px' style='width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;' loading='lazy' decoding='async'>\n  </a>\n    </span>\n    <figcaption class='gatsby-resp-image-figcaption'>게시한 사이트의 이미지 URL</figcaption>\n  </figure>\n먼저 노션으로 게시한 사이트에 들어가 개발자 모드로 사진의 URL 원문을 가져와 분석해 보았다. </p>\n<h4 id=\"a-메인-URL과-imageattachment\" style=\"position:relative;\"><a href=\"#a-%EB%A9%94%EC%9D%B8-URL%EA%B3%BC-imageattachment\" aria-label=\"a 메인 URL과 imageattachment permalink\" class=\"heading-anchor before\"><svg xmlns=\"http://www.w3.org/2000/svg\" width=\"15\" height=\"15\" viewBox=\"0 0 24 24\"><path d=\"M6.188 8.719c.439-.439.926-.801 1.444-1.087 2.887-1.591 6.589-.745 8.445 2.069l-2.246 2.245c-.644-1.469-2.243-2.305-3.834-1.949-.599.134-1.168.433-1.633.898l-4.304 4.306c-1.307 1.307-1.307 3.433 0 4.74 1.307 1.307 3.433 1.307 4.74 0l1.327-1.327c1.207.479 2.501.67 3.779.575l-2.929 2.929c-2.511 2.511-6.582 2.511-9.093 0s-2.511-6.582 0-9.093l4.304-4.306zm6.836-6.836l-2.929 2.929c1.277-.096 2.572.096 3.779.574l1.326-1.326c1.307-1.307 3.433-1.307 4.74 0 1.307 1.307 1.307 3.433 0 4.74l-4.305 4.305c-1.311 1.311-3.44 1.3-4.74 0-.303-.303-.564-.68-.727-1.051l-2.246 2.245c.236.358.481.667.796.982.812.812 1.846 1.417 3.036 1.704 1.542.371 3.194.166 4.613-.617.518-.286 1.005-.648 1.444-1.087l4.304-4.305c2.512-2.511 2.512-6.582.001-9.093-2.511-2.51-6.581-2.51-9.092 0z\"/></svg></a>a. 메인 URL과 /image/attachment</h4>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">https://{노션 페이지 메인 URL}/image/attachment...</code></pre></div>\n<p>앞쪽의 메인 URL은 노션에서 페이지를 게시할 때 주어지는 메인 URL과 동일했다. 이후<code class=\"language-text\">/image/attachment</code>라고 붙는 것까지 알 수 있다.</p>\n<h4 id=\"b-attachment와-연결되어-있는-부분\" style=\"position:relative;\"><a href=\"#b-attachment%EC%99%80-%EC%97%B0%EA%B2%B0%EB%90%98%EC%96%B4-%EC%9E%88%EB%8A%94-%EB%B6%80%EB%B6%84\" aria-label=\"b attachment와 연결되어 있는 부분 permalink\" class=\"heading-anchor before\"><svg xmlns=\"http://www.w3.org/2000/svg\" width=\"15\" height=\"15\" viewBox=\"0 0 24 24\"><path d=\"M6.188 8.719c.439-.439.926-.801 1.444-1.087 2.887-1.591 6.589-.745 8.445 2.069l-2.246 2.245c-.644-1.469-2.243-2.305-3.834-1.949-.599.134-1.168.433-1.633.898l-4.304 4.306c-1.307 1.307-1.307 3.433 0 4.74 1.307 1.307 3.433 1.307 4.74 0l1.327-1.327c1.207.479 2.501.67 3.779.575l-2.929 2.929c-2.511 2.511-6.582 2.511-9.093 0s-2.511-6.582 0-9.093l4.304-4.306zm6.836-6.836l-2.929 2.929c1.277-.096 2.572.096 3.779.574l1.326-1.326c1.307-1.307 3.433-1.307 4.74 0 1.307 1.307 1.307 3.433 0 4.74l-4.305 4.305c-1.311 1.311-3.44 1.3-4.74 0-.303-.303-.564-.68-.727-1.051l-2.246 2.245c.236.358.481.667.796.982.812.812 1.846 1.417 3.036 1.704 1.542.371 3.194.166 4.613-.617.518-.286 1.005-.648 1.444-1.087l4.304-4.305c2.512-2.511 2.512-6.582.001-9.093-2.511-2.51-6.581-2.51-9.092 0z\"/></svg></a>b. attachment와 연결되어 있는 부분</h4>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">attachment%3Ae8c63e9b-e829-4dc5-852c-ba11b43ca491%3A01.jpg</code></pre></div>\n<p>%으로 시작되는 부분부터 jpg로 끝나는 부분 중 유추 가능한 점은 jpg로 끝나는 끝부분에 사진의 이름과 확장자가 붙어 있다는 것이다. 해당 사진의 원본 이름은 <code class=\"language-text\">01.jpg</code>이기 때문에 나머지 부분이 해당 사진의 특정 식별자 라는 것을 유추할 수 있다.</p>\n<p><code class=\"language-text\">%3Ae8c63e9b-e829-4dc5-852c-ba11b43ca491%3A</code>이라는 문자열을 URL Decoder로 디코딩 하게 되면 <code class=\"language-text\">:e8c63e9b-e829-4dc5-852c-ba11b43ca491:</code>이라는 결과를 얻게 되며 <code class=\"language-text\">%3A</code>라는 값이 <code class=\"language-text\">:</code>을 URL로 인코딩한 값이라는 것을 알게 된다. </p>\n<p>위 값에서 나온 <code class=\"language-text\">e8c63e9b-e829-4dc5-852c-ba11b43ca491</code>이라는 값을 노션 API의 응답 json에서 찾아본결과 file URL에 포함되어 있는 값이라는 것을 알 수 있었다.\n<figure class='gatsby-resp-image-figure' style='margin-bottom: 16px;'>\n    <span class='gatsby-resp-image-wrapper' style='position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 680px; '>\n      <a class='gatsby-resp-image-link' href='/blog/static/f88e3789eb5d47dd020034eeaf778c0e/5f7f3/n-5.png' style='display: block' target='_blank' rel='noopener'>\n    <span class='gatsby-resp-image-background-image' style=\"padding-bottom: 33.529411764705884%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAHCAYAAAAIy204AAAACXBIWXMAAAsTAAALEwEAmpwYAAABZklEQVR42kWRW0/CQBSE+0Okeym7vbdgoVSoBoSggIkajSZ4wwcT4/9/H6dLjA9f5uzJObPTrReGIeIkgY2oaQwbR+h6URTBWutqrTWUUo6u1kpDGg2RaARB4Hr9fh8mLuDVdQ3LpSRNEdIspRpjuKQgpXT8mSklj0gFYRR6qXIXZlnGAF2wFN5/AgnLRpzmMJoLzoymzrg7C1TjEtNZjWZaoWkqjEcDGMvEfQkd8CIt4Gkua5o5pbHhBWFMYxMgUAJC+JBE+D0mE5wlVKWEC+Gz7/snbk4IGprunRi3w1iDiCmH9RmK8hRhOYbNR7DF6KgkHkwQD8+otZvtPjNiABse39yLOJw3S2STOVk4Utbl6gnDzfuR7Qc5oLr5RPv4g/bhG+39F2a3B0c13yGrGmT8qV5Iw6xZ0WSBZHLJesl6ScNnDK5eyB7D61fyhsF6j5IU8zvk7QbFxQ75+RZFV0/XKCZz/AI2rNXKLEdxMwAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"></span>\n  <img class='gatsby-resp-image-image' alt='Postman을 사용하여 값을 확인한 화면' title='' src='/blog/static/f88e3789eb5d47dd020034eeaf778c0e/ca1dc/n-5.png' srcset='/blog/static/f88e3789eb5d47dd020034eeaf778c0e/e7570/n-5.png 170w,\n/blog/static/f88e3789eb5d47dd020034eeaf778c0e/f46e7/n-5.png 340w,\n/blog/static/f88e3789eb5d47dd020034eeaf778c0e/ca1dc/n-5.png 680w,\n/blog/static/f88e3789eb5d47dd020034eeaf778c0e/5f7f3/n-5.png 971w' sizes='(max-width: 680px) 100vw, 680px' style='width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;' loading='lazy' decoding='async'>\n  </a>\n    </span>\n    <figcaption class='gatsby-resp-image-figcaption'>Postman을 사용하여 값을 확인한 화면</figcaption>\n  </figure></p>\n<h4 id=\"c-queryString의-id-부분\" style=\"position:relative;\"><a href=\"#c-queryString%EC%9D%98-id-%EB%B6%80%EB%B6%84\" aria-label=\"c queryString의 id 부분 permalink\" class=\"heading-anchor before\"><svg xmlns=\"http://www.w3.org/2000/svg\" width=\"15\" height=\"15\" viewBox=\"0 0 24 24\"><path d=\"M6.188 8.719c.439-.439.926-.801 1.444-1.087 2.887-1.591 6.589-.745 8.445 2.069l-2.246 2.245c-.644-1.469-2.243-2.305-3.834-1.949-.599.134-1.168.433-1.633.898l-4.304 4.306c-1.307 1.307-1.307 3.433 0 4.74 1.307 1.307 3.433 1.307 4.74 0l1.327-1.327c1.207.479 2.501.67 3.779.575l-2.929 2.929c-2.511 2.511-6.582 2.511-9.093 0s-2.511-6.582 0-9.093l4.304-4.306zm6.836-6.836l-2.929 2.929c1.277-.096 2.572.096 3.779.574l1.326-1.326c1.307-1.307 3.433-1.307 4.74 0 1.307 1.307 1.307 3.433 0 4.74l-4.305 4.305c-1.311 1.311-3.44 1.3-4.74 0-.303-.303-.564-.68-.727-1.051l-2.246 2.245c.236.358.481.667.796.982.812.812 1.846 1.417 3.036 1.704 1.542.371 3.194.166 4.613-.617.518-.286 1.005-.648 1.444-1.087l4.304-4.305c2.512-2.511 2.512-6.582.001-9.093-2.511-2.51-6.581-2.51-9.092 0z\"/></svg></a>c. queryString의 id 부분</h4>\n<p>해당 부분은 따로 인코딩된 부분이 없기 때문에 바로 노션 API의 응답에서 찾아 보았다. 확인 결과 노션 API에서 가져올 수 있는 id 값이였다.\n<figure class='gatsby-resp-image-figure' style='margin-bottom: 16px;'>\n    <span class='gatsby-resp-image-wrapper' style='position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 680px; '>\n      <a class='gatsby-resp-image-link' href='/blog/static/27e8f967b4994e45292ee07049d8c33a/5f7f3/n-6.png' style='display: block' target='_blank' rel='noopener'>\n    <span class='gatsby-resp-image-background-image' style=\"padding-bottom: 33.529411764705884%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAHCAYAAAAIy204AAAACXBIWXMAAAsTAAALEwEAmpwYAAABJklEQVR42o2QSVbDMBBEfRCwNY+2ZRInZH4hsOD+FypKThY8WMDiv1arpe6uapxziCnBeocQI1zw8P5OrdWolPqFtArCP85SQmsNE3o08zzDx4CcE0KKSGyujVkedUIstJ2AEJIw7zp0bYdnL/CUxTIw54zIZWLKaCKbKX52gc14OTLvgyMeQySMUwoIzmC9KTgcZhyOG+x3a2znCcYpoqGthFQdGqUklFbcMqIMPVZ9xK7khdfxHk+rstyXzGHJw1jKMxXFjVu0bbvESmMob/EqJozjiJcyIfUjUh4oZaAF+e4P31X0Dy9r7TuNcxbWWkzbPU63T5yvH3g7nXE7X/B+ufB8hOdA/Wj4F01dvcoO/YCy2SPRM0cLKp6SAuvOGgj6LP/BFxUjzB1U30H2AAAAAElFTkSuQmCC'); background-size: cover; display: block;\"></span>\n  <img class='gatsby-resp-image-image' alt='특정 페이지의 id 값을 의미한다는 것을 확인할 수 있다' title='' src='/blog/static/27e8f967b4994e45292ee07049d8c33a/ca1dc/n-6.png' srcset='/blog/static/27e8f967b4994e45292ee07049d8c33a/e7570/n-6.png 170w,\n/blog/static/27e8f967b4994e45292ee07049d8c33a/f46e7/n-6.png 340w,\n/blog/static/27e8f967b4994e45292ee07049d8c33a/ca1dc/n-6.png 680w,\n/blog/static/27e8f967b4994e45292ee07049d8c33a/5f7f3/n-6.png 971w' sizes='(max-width: 680px) 100vw, 680px' style='width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;' loading='lazy' decoding='async'>\n  </a>\n    </span>\n    <figcaption class='gatsby-resp-image-figcaption'>특정 페이지의 id 값을 의미한다는 것을 확인할 수 있다</figcaption>\n  </figure></p>\n<h4 id=\"d-필요하지-않는-값-spaceid-userid\" style=\"position:relative;\"><a href=\"#d-%ED%95%84%EC%9A%94%ED%95%98%EC%A7%80-%EC%95%8A%EB%8A%94-%EA%B0%92-spaceid-userid\" aria-label=\"d 필요하지 않는 값 spaceid userid permalink\" class=\"heading-anchor before\"><svg xmlns=\"http://www.w3.org/2000/svg\" width=\"15\" height=\"15\" viewBox=\"0 0 24 24\"><path d=\"M6.188 8.719c.439-.439.926-.801 1.444-1.087 2.887-1.591 6.589-.745 8.445 2.069l-2.246 2.245c-.644-1.469-2.243-2.305-3.834-1.949-.599.134-1.168.433-1.633.898l-4.304 4.306c-1.307 1.307-1.307 3.433 0 4.74 1.307 1.307 3.433 1.307 4.74 0l1.327-1.327c1.207.479 2.501.67 3.779.575l-2.929 2.929c-2.511 2.511-6.582 2.511-9.093 0s-2.511-6.582 0-9.093l4.304-4.306zm6.836-6.836l-2.929 2.929c1.277-.096 2.572.096 3.779.574l1.326-1.326c1.307-1.307 3.433-1.307 4.74 0 1.307 1.307 1.307 3.433 0 4.74l-4.305 4.305c-1.311 1.311-3.44 1.3-4.74 0-.303-.303-.564-.68-.727-1.051l-2.246 2.245c.236.358.481.667.796.982.812.812 1.846 1.417 3.036 1.704 1.542.371 3.194.166 4.613-.617.518-.286 1.005-.648 1.444-1.087l4.304-4.305c2.512-2.511 2.512-6.582.001-9.093-2.511-2.51-6.581-2.51-9.092 0z\"/></svg></a>d. 필요하지 않는 값 (spaceid, userid)</h4>\n<p>spaceid와 useid값의 경우 값을 추가하지 않아도 사진 데이터를 불러오는데 문제가 없었기 때문에 추가하지 않기로 하였다.</p>\n<h4 id=\"e-나머지-고정값-table-cache-width\" style=\"position:relative;\"><a href=\"#e-%EB%82%98%EB%A8%B8%EC%A7%80-%EA%B3%A0%EC%A0%95%EA%B0%92-table-cache-width\" aria-label=\"e 나머지 고정값 table cache width permalink\" class=\"heading-anchor before\"><svg xmlns=\"http://www.w3.org/2000/svg\" width=\"15\" height=\"15\" viewBox=\"0 0 24 24\"><path d=\"M6.188 8.719c.439-.439.926-.801 1.444-1.087 2.887-1.591 6.589-.745 8.445 2.069l-2.246 2.245c-.644-1.469-2.243-2.305-3.834-1.949-.599.134-1.168.433-1.633.898l-4.304 4.306c-1.307 1.307-1.307 3.433 0 4.74 1.307 1.307 3.433 1.307 4.74 0l1.327-1.327c1.207.479 2.501.67 3.779.575l-2.929 2.929c-2.511 2.511-6.582 2.511-9.093 0s-2.511-6.582 0-9.093l4.304-4.306zm6.836-6.836l-2.929 2.929c1.277-.096 2.572.096 3.779.574l1.326-1.326c1.307-1.307 3.433-1.307 4.74 0 1.307 1.307 1.307 3.433 0 4.74l-4.305 4.305c-1.311 1.311-3.44 1.3-4.74 0-.303-.303-.564-.68-.727-1.051l-2.246 2.245c.236.358.481.667.796.982.812.812 1.846 1.417 3.036 1.704 1.542.371 3.194.166 4.613-.617.518-.286 1.005-.648 1.444-1.087l4.304-4.305c2.512-2.511 2.512-6.582.001-9.093-2.511-2.51-6.581-2.51-9.092 0z\"/></svg></a>e. 나머지 고정값 (table, cache, width)</h4>\n<p>table과 cache값의 경우 모든 사진 URL에서 고정으로 동일한 값이 들어가기 때문에 해당 값을 그대로 추가하였다. width값은 1000정도로 사용하기로 하였다.</p>\n<ul>\n<li>table: block</li>\n<li>cache: v2</li>\n<li>width: 1000</li>\n</ul>\n<p>최종적으로 분석한 값들을 조합하면 다음과 같다.</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">https://{노션 페이지 메인 URL}/image/attachment%3A{노션 API의 url에 포함된 고유 id}%3A{파일 원본 이름}?id={노션 api의 특정 페이지 id}&amp;width=1000&amp;table=block&amp;cache=v2</code></pre></div>\n<h3 id=\"노션-api-URL을-게시-페이지-이미지-URL로-변환\" style=\"position:relative;\"><a href=\"#%EB%85%B8%EC%85%98-api-URL%EC%9D%84-%EA%B2%8C%EC%8B%9C-%ED%8E%98%EC%9D%B4%EC%A7%80-%EC%9D%B4%EB%AF%B8%EC%A7%80-URL%EB%A1%9C-%EB%B3%80%ED%99%98\" aria-label=\"노션 api URL을 게시 페이지 이미지 URL로 변환 permalink\" class=\"heading-anchor before\"><svg xmlns=\"http://www.w3.org/2000/svg\" width=\"15\" height=\"15\" viewBox=\"0 0 24 24\"><path d=\"M6.188 8.719c.439-.439.926-.801 1.444-1.087 2.887-1.591 6.589-.745 8.445 2.069l-2.246 2.245c-.644-1.469-2.243-2.305-3.834-1.949-.599.134-1.168.433-1.633.898l-4.304 4.306c-1.307 1.307-1.307 3.433 0 4.74 1.307 1.307 3.433 1.307 4.74 0l1.327-1.327c1.207.479 2.501.67 3.779.575l-2.929 2.929c-2.511 2.511-6.582 2.511-9.093 0s-2.511-6.582 0-9.093l4.304-4.306zm6.836-6.836l-2.929 2.929c1.277-.096 2.572.096 3.779.574l1.326-1.326c1.307-1.307 3.433-1.307 4.74 0 1.307 1.307 1.307 3.433 0 4.74l-4.305 4.305c-1.311 1.311-3.44 1.3-4.74 0-.303-.303-.564-.68-.727-1.051l-2.246 2.245c.236.358.481.667.796.982.812.812 1.846 1.417 3.036 1.704 1.542.371 3.194.166 4.613-.617.518-.286 1.005-.648 1.444-1.087l4.304-4.305c2.512-2.511 2.512-6.582.001-9.093-2.511-2.51-6.581-2.51-9.092 0z\"/></svg></a>노션 api URL을 게시 페이지 이미지 URL로 변환</h3>\n<p>분석한 규칙을 바탕으로 게시 페이지 이미지 URL 반환 함수를 작성해 준다.</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">function</span> <span class=\"token function\">notionFileUrlGenerator</span><span class=\"token punctuation\">(</span><span class=\"token parameter\"><span class=\"token literal-property property\">originUrl</span><span class=\"token operator\">:</span> string<span class=\"token punctuation\">,</span> <span class=\"token literal-property property\">resultID</span><span class=\"token operator\">:</span> string</span><span class=\"token punctuation\">)</span><span class=\"token operator\">:</span> string <span class=\"token punctuation\">{</span>\n\t<span class=\"token comment\">// 원본 URL에서 필요한 부분만 추출</span>\n\t<span class=\"token keyword\">const</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">,</span> imageId<span class=\"token punctuation\">,</span> imageName<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> originUrl<span class=\"token punctuation\">.</span><span class=\"token function\">split</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"//\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span><span class=\"token function\">split</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"?\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span><span class=\"token function\">split</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"/\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t\n\t<span class=\"token comment\">// 게시 페이지의 정적 URL로 가공</span>\n\t<span class=\"token keyword\">const</span> resultUrl <span class=\"token operator\">=</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>process<span class=\"token punctuation\">.</span>env<span class=\"token punctuation\">.</span><span class=\"token constant\">NOTION_PAGE_URL</span><span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">/image/attachment</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span><span class=\"token function\">encodeURIComponent</span><span class=\"token punctuation\">(</span><span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">:</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>imageId<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">:</span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">)</span><span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>imageName<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">?id=</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>resultID<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">&amp;width=1000&amp;table=block&amp;cache=v2</span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">;</span>\n\t\n\t<span class=\"token keyword\">return</span> resultUrl<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>해당 함수를 DTO to Entity mapper 함수에서 사용하여 노션 API의 만료 기간이 있는 이미지 URL을 게시 페이지의 정적 URL로 변환 후 사용하도록 한다.</p>\n<h2 id=\"결과\" style=\"position:relative;\"><a href=\"#%EA%B2%B0%EA%B3%BC\" aria-label=\"결과 permalink\" class=\"heading-anchor before\"><svg xmlns=\"http://www.w3.org/2000/svg\" width=\"15\" height=\"15\" viewBox=\"0 0 24 24\"><path d=\"M6.188 8.719c.439-.439.926-.801 1.444-1.087 2.887-1.591 6.589-.745 8.445 2.069l-2.246 2.245c-.644-1.469-2.243-2.305-3.834-1.949-.599.134-1.168.433-1.633.898l-4.304 4.306c-1.307 1.307-1.307 3.433 0 4.74 1.307 1.307 3.433 1.307 4.74 0l1.327-1.327c1.207.479 2.501.67 3.779.575l-2.929 2.929c-2.511 2.511-6.582 2.511-9.093 0s-2.511-6.582 0-9.093l4.304-4.306zm6.836-6.836l-2.929 2.929c1.277-.096 2.572.096 3.779.574l1.326-1.326c1.307-1.307 3.433-1.307 4.74 0 1.307 1.307 1.307 3.433 0 4.74l-4.305 4.305c-1.311 1.311-3.44 1.3-4.74 0-.303-.303-.564-.68-.727-1.051l-2.246 2.245c.236.358.481.667.796.982.812.812 1.846 1.417 3.036 1.704 1.542.371 3.194.166 4.613-.617.518-.286 1.005-.648 1.444-1.087l4.304-4.305c2.512-2.511 2.512-6.582.001-9.093-2.511-2.51-6.581-2.51-9.092 0z\"/></svg></a>결과</h2>\n<p><figure class='gatsby-resp-image-figure' style='margin-bottom: 16px;'>\n    <span class='gatsby-resp-image-wrapper' style='position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 680px; '>\n      <a class='gatsby-resp-image-link' href='/blog/static/b3faf9f39bd48ec89a41e027c1a7698c/0d1d8/n-7.png' style='display: block' target='_blank' rel='noopener'>\n    <span class='gatsby-resp-image-background-image' style=\"padding-bottom: 60.58823529411765%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAYAAABiDJ37AAAACXBIWXMAABYlAAAWJQFJUiTwAAAC9klEQVR42lWTy09TaRjGWTjJQInQnp5zeno9bemhFyg0LdeKBZnSCoU4eAvWEVSiBCu2KE1AtAreEi8LTcg43pJxEmbBckxm5crEjQuX+tf8/Hpw1Fk8yfd9i9/7vO/zfg2GYRCNRk1pmobL5cLp1HBqDnF2mve63G43DoeKJNl+kBXZbhfvDlRVNdUgSRJWqxWf7ifYFiIYDOIVZ48RxjDaBdyFz+cjEAgiKwqNTRaaLM1YvqrJYqGlpRVZlrELeEOdqigqx48colpeoHRxkevl89yb7Kd4fJqNzXXm5+c4fWqGtZVLrF4ps7pSplopUV0ucbVaJj82apoyHSqiqqLI3Lx5g/f/bvPu7Q4ftzb4p5Dh8upVPn/6wNPHm9wrzbOz9ZC/Htzi9Z1r/Hmrxsv7t9l+8oC5Y4fZK1w66kBZVsyZHciOU7lwls1rJZ4tzPBoosDRs+fY2X7O+WKO0YEUuf29ZPf1MDk6zGBXlP2puHhL0x7URbsydXO7DgU5f2CIk9PjHP11itpiga3aHJUrl7l9fYWCaKk7HmOwN0EooJNMJBga6CWV6KYjHMbvdZsz/Aas9354JMkv3UGKuTS/ZftYFq7WqkvMHxlhMBWjsyNGl5BLJKp7PDSLMPbs+QlLYyOKLJk5fAM6VAeRgMHwQJpp4SYT1hlq9zKZ7aeQzTOWSaPKdiJtOoloiHg4hBH0E9C9GG1+c73+57B+0Vw6I8NZJgpTJAI2dHsr8e44Uz0Jch1huiI+lmYLvHm2xttXNd48rbH9eJ2d329QnM5/D2U3ZWFX1ojHkyTTWVy2n/EIYDgSoi/gpUe1kunvZKE4zuv7l/j7YYU/NhZ5sj7Li7tLnDg0Rkur9TvQ3EW7hE3Z/R2GZsHvljB0UcTwEzMCGH6NXCZFZW6C5dkJFmfynJwc4syxg2QGk9hs0tc9VHeHqcg2VIeGW3wzn9NKxNuIR2nG51LwuDU8TpneRJR0MszBdIzRvhiZvk729XQQFUX/W5sv88iQP7GrnvYAAAAASUVORK5CYII='); background-size: cover; display: block;\"></span>\n  <img class='gatsby-resp-image-image' alt='정상적으로 이미지가 뜨는 모습' title='' src='/blog/static/b3faf9f39bd48ec89a41e027c1a7698c/ca1dc/n-7.png' srcset='/blog/static/b3faf9f39bd48ec89a41e027c1a7698c/e7570/n-7.png 170w,\n/blog/static/b3faf9f39bd48ec89a41e027c1a7698c/f46e7/n-7.png 340w,\n/blog/static/b3faf9f39bd48ec89a41e027c1a7698c/ca1dc/n-7.png 680w,\n/blog/static/b3faf9f39bd48ec89a41e027c1a7698c/02d09/n-7.png 1020w,\n/blog/static/b3faf9f39bd48ec89a41e027c1a7698c/9d567/n-7.png 1360w,\n/blog/static/b3faf9f39bd48ec89a41e027c1a7698c/0d1d8/n-7.png 2758w' sizes='(max-width: 680px) 100vw, 680px' style='width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;' loading='lazy' decoding='async'>\n  </a>\n    </span>\n    <figcaption class='gatsby-resp-image-figcaption'>정상적으로 이미지가 뜨는 모습</figcaption>\n  </figure>\n이미지의 만료 기간이 없기 때문에 언제든 사진이 잘 나온다.</p>\n<p><figure class='gatsby-resp-image-figure' style='margin-bottom: 16px;'>\n    <span class='gatsby-resp-image-wrapper' style='position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 680px; '>\n      <a class='gatsby-resp-image-link' href='/blog/static/70a7e6a964b36ac6aa7bc0758a3d2830/ba4f0/n-8.png' style='display: block' target='_blank' rel='noopener'>\n    <span class='gatsby-resp-image-background-image' style=\"padding-bottom: 54.70588235294118%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAABYlAAAWJQFJUiTwAAABlElEQVR42o2SO04DQQyGxzOz790sy5IHC1kIIBRFUCARikiQgoYOIlFQUKLcBm5AR8EJuAL34CI/9oZlI4gEhWXLsj//9owiUugWffSKLbTbbRRFAc/zoJT604gIcRwjyzJEUVTnFRJOrq2lSNOF+b4Px3EW5rrQbgjSeiXQWvszr2CMgeVmzU1SINMEKkoFSMQwapqkRoYJMAgCjMdjjEajBiiqRLZABJbnOZIkQRiGK9eXuiDwQBxL7Xw+x2w2a4CtVqtqlnvI5P/cTyli+30GJbJr+WKytjbOl7dshmOziCWn2XOjnj5CXb1gr+zh9GyCflk2QLlhBauB0sBeVtJ1XmKGUjqoYrp+hbp/x3C3i4vJKQa7Ow1QGkhUWVbqxtDDO1DYgd44gl4/BMWb0NvnID8HPXyAykvQ9Al084by8ATbt8/oDY7rtRcKjRPA+EkFtvkQZEOYpICOOtUQm+1D8bom7YO4VgcZdNiGF8TwNw5gvWgJaN1qxf89xm9zDH83FvX9ys2r0VK87JdiohX1jX0CftX1Cer+Uv8AAAAASUVORK5CYII='); background-size: cover; display: block;\"></span>\n  <img class='gatsby-resp-image-image' alt='26,909 -&gt; 5,906으로 이미지 캐시 쓰기가 줄어든 모습' title='' src='/blog/static/70a7e6a964b36ac6aa7bc0758a3d2830/ca1dc/n-8.png' srcset='/blog/static/70a7e6a964b36ac6aa7bc0758a3d2830/e7570/n-8.png 170w,\n/blog/static/70a7e6a964b36ac6aa7bc0758a3d2830/f46e7/n-8.png 340w,\n/blog/static/70a7e6a964b36ac6aa7bc0758a3d2830/ca1dc/n-8.png 680w,\n/blog/static/70a7e6a964b36ac6aa7bc0758a3d2830/02d09/n-8.png 1020w,\n/blog/static/70a7e6a964b36ac6aa7bc0758a3d2830/9d567/n-8.png 1360w,\n/blog/static/70a7e6a964b36ac6aa7bc0758a3d2830/ba4f0/n-8.png 2710w' sizes='(max-width: 680px) 100vw, 680px' style='width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;' loading='lazy' decoding='async'>\n  </a>\n    </span>\n    <figcaption class='gatsby-resp-image-figcaption'>26,909 -&gt; 5,906으로 이미지 캐시 쓰기가 줄어든 모습</figcaption>\n  </figure>\n또한, 이미지 캐시 쓰기의 횟수가 26,909번에서 5,906번으로 약 <strong>78.1%</strong> 개선된 것을 확인할 수 있다.</p>\n<h3 id=\"참고자료\" style=\"position:relative;\"><a href=\"#%EC%B0%B8%EA%B3%A0%EC%9E%90%EB%A3%8C\" aria-label=\"참고자료 permalink\" class=\"heading-anchor before\"><svg xmlns=\"http://www.w3.org/2000/svg\" width=\"15\" height=\"15\" viewBox=\"0 0 24 24\"><path d=\"M6.188 8.719c.439-.439.926-.801 1.444-1.087 2.887-1.591 6.589-.745 8.445 2.069l-2.246 2.245c-.644-1.469-2.243-2.305-3.834-1.949-.599.134-1.168.433-1.633.898l-4.304 4.306c-1.307 1.307-1.307 3.433 0 4.74 1.307 1.307 3.433 1.307 4.74 0l1.327-1.327c1.207.479 2.501.67 3.779.575l-2.929 2.929c-2.511 2.511-6.582 2.511-9.093 0s-2.511-6.582 0-9.093l4.304-4.306zm6.836-6.836l-2.929 2.929c1.277-.096 2.572.096 3.779.574l1.326-1.326c1.307-1.307 3.433-1.307 4.74 0 1.307 1.307 1.307 3.433 0 4.74l-4.305 4.305c-1.311 1.311-3.44 1.3-4.74 0-.303-.303-.564-.68-.727-1.051l-2.246 2.245c.236.358.481.667.796.982.812.812 1.846 1.417 3.036 1.704 1.542.371 3.194.166 4.613-.617.518-.286 1.005-.648 1.444-1.087l4.304-4.305c2.512-2.511 2.512-6.582.001-9.093-2.511-2.51-6.581-2.51-9.092 0z\"/></svg></a>참고자료</h3>\n<ul>\n<li><a href=\"https://velog.io/@soooee/%EB%85%B8%EC%85%98-API-%EC%9D%B4%EB%AF%B8%EC%A7%80-%EC%82%AC%EC%9A%A9-%EC%8B%9C-URL-%EB%A7%8C%EB%A3%8C-%EB%AC%B8%EC%A0%9C-%ED%95%B4%EA%B2%B0%ED%95%98%EA%B8%B0\">https://velog.io/@soooee/%EB%85%B8%EC%85%98-API-%EC%9D%B4%EB%AF%B8%EC%A7%80-%EC%82%AC%EC%9A%A9-%EC%8B%9C-URL-%EB%A7%8C%EB%A3%8C-%EB%AC%B8%EC%A0%9C-%ED%95%B4%EA%B2%B0%ED%95%98%EA%B8%B0</a></li>\n<li><a href=\"https://weezip.treefeely.com/post/weezip-use-notion-image\">https://weezip.treefeely.com/post/weezip-use-notion-image</a></li>\n</ul>","frontmatter":{"title":"Notion API의 이미지를 만료기간 없이 사용하고 성능 개선하기","date":"August 29, 2025","update":"August 29, 2025","tags":["Notion-API"],"series":null},"fields":{"slug":"/NotionApiImageUrl/","readingTime":{"minutes":7.8}}},"seriesList":{"edges":[{"node":{"id":"dcfd0d40-676e-54f2-9f99-d6d104e06fa8","fields":{"slug":"/Cors/"},"frontmatter":{"title":"CORS 알아보기"}}},{"node":{"id":"b750f209-8fdc-5f45-9238-c7c64fa37870","fields":{"slug":"/SEO/"},"frontmatter":{"title":"SEO 파먹기"}}},{"node":{"id":"a0e96c02-0dd5-56d6-b6f5-c55f579916c9","fields":{"slug":"/OptimisticUI/"},"frontmatter":{"title":"낙관적 UI 알아보기"}}},{"node":{"id":"095c65d5-fcc7-52e9-81c3-c2fb94b5a36c","fields":{"slug":"/NotionApiImageUrl/"},"frontmatter":{"title":"Notion API의 이미지를 만료기간 없이 사용하고 성능 개선하기"}}},{"node":{"id":"47a7d81b-031f-57a4-a65c-3b00d071d6d9","fields":{"slug":"/DNSRecord/"},"frontmatter":{"title":"DNS 레코드"}}},{"node":{"id":"f569afc7-613b-5153-82ff-c208a9f6ff76","fields":{"slug":"/about/"},"frontmatter":{"title":"💻 조병진 | Web & App Developer"}}}]},"previous":{"fields":{"slug":"/OptimisticUI/"},"frontmatter":{"title":"낙관적 UI 알아보기"}},"next":{"fields":{"slug":"/DNSRecord/"},"frontmatter":{"title":"DNS 레코드"}}},"pageContext":{"id":"095c65d5-fcc7-52e9-81c3-c2fb94b5a36c","series":null,"previousPostId":"a0e96c02-0dd5-56d6-b6f5-c55f579916c9","nextPostId":"47a7d81b-031f-57a4-a65c-3b00d071d6d9"}},"staticQueryHashes":[],"slicesMap":{}}